<div class="center-loader" *ngIf="loader">
    <strong>Cargando producto
            <span class="loader__dot">.</span>
            <span class="loader__dot">.</span>
            <span class="loader__dot">.</span></strong>
</div>

<div class="container col-md-6" *ngIf="!loader">
    <div class="card">
        <div class="card-header">
            <h3>Producto</h3>
        </div>
        <div class="card-body">
            <form action="" #f="ngForm" novalidate>
                <div>
                    <div *ngIf="administrador; then thenBlock1 ">
                    </div>

                    <ng-template #thenBlock1>
                        <label for="">Empresa</label>
                        <div class="center-loader" *ngIf="loader">
                            <strong>Cargando empresas
                              <span class="loader__dot">.</span>
                              <span class="loader__dot">.</span>
                              <span class="loader__dot">.</span></strong>
                        </div>
                        <!-- <select *ngIf="!loader" class="form-control" name="empresaSeleccionada" [(ngModel)]="empresaSeleccionada" (change)="capturarEmpresa()">
                          <option value="0">Selecciona una empresa</option>
                          <option *ngFor="let empresa of empresas" style="margin-block: 10px">
                              {{empresa.razonSocial}}
                          </option>
                      </select>-->
                    </ng-template>
                    <!-- <div *ngIf="categoriasNoVacia; then thenBlock2 else elseBlock2">-->
                </div>
                <ng-template #thenBlock2>
                    <label for="let categoria of categorias">Categoria</label>
                    <select class="form-control" name="categoriaSeleccionada" [(ngModel)]="categoriaSeleccionada" name="categoriaSeleccionada">
                          <option value="0">Selecciona una Categoria</option>
                          <option *ngFor="let categoria of categorias" style="margin-block: 10px">
                              {{categoria.nombreCategoria}}
                          </option>
                      </select>
                </ng-template>
                <ng-template #elseBlock2>
                    <div class="center-loader">
                        <strong>Cargando categorias
                              <span class=" loader__dot ">.</span>
                              <span class="loader__dot ">.</span>
                              <span class="loader__dot ">.</span></strong>
                    </div>
                </ng-template>
            </form>
        </div>
        <div class="form-group ">
            <label for=" ">Nombre Producto</label>
            <input type="text " class="form-control " [(ngModel)]="producto.nombreProducto " name="nombre" required>
        </div>
        <div class="form-group ">
            <label for=" ">Descripcion</label>
            <input type="text " class="form-control " [(ngModel)]="producto.descripcion " name="descripcion" required>
        </div>
        <div class="form-group ">
            <label for=" ">Stock</label>
            <input type="number " class="form-control " [(ngModel)]="producto.stockProducto " name="stockProducto" required>
        </div>
        <div class="form-group ">
            <label for=" ">Precio</label>
            <input type="number " class="form-control " [(ngModel)]="producto.valorProducto " name="valorProducto" required>
        </div>
        <h5>imagen por defecto</h5>
        <input type="checkbox" name="imgDefecto" />
        <input type="checkbox" name="imgDefecto" />
        <input type="checkbox" name="imgDefecto" />
        <input type="checkbox" name="imgDefecto" />
        <input type="checkbox" name="imgDefecto" />
            <!-- <br>
                  <input type="file" class="btn btn-dark " (change)="onFileChanged($event)">-->
            <hr>
            <div *ngIf="producto.imagen!=1; else elseBlock4">


                <div *ngIf="!imageCargada; else elseBlock3">
                    <button class="btn btn-success " (click)="seleccionarImagen(cargarImagen) ">Seleccionar imagen</button>
                </div>
                <h1></h1>
                <ng-template #elseBlock3>
                    <div class="card-img-top">
                        <div class="background" *ngIf="imageCargada.retrievedImages">
                            <img [src]="imageCargada.retrievedImages">

                        </div>
                    </div>
                    <br>
                    <button class="btn btn-success " (click)="seleccionarImagen(cargarImagen) ">Cambiar imagen</button>
                </ng-template>
                <hr>
            </div>
            <ng-template #elseBlock4>

                <img src="assets/imageLogo/IsotipoCromaticoVectorialfondoblanco50x50.png">
                <br>
                <button class="btn btn-success " (click)="seleccionarImagen(cargarImagen) ">Cambiar imagen</button>
            </ng-template>
        </div>

        <div class="form-group ">
            <div class="form-group ">
                <div class="col-md-12 ">
                    <div></div>
                </div>
            </div>

        </div>

        <div class="container row ">
            <div class="col-md-12 ">
                <div *ngIf=retrievedImage>
                    <img [src]="retrievedImage ">
                </div>
            </div>
        </div>

        <button class="btn btn-danger " (click)="actualizarProducto() " [disabled]="!f.valid ">Guardar</button>


        <!--<div class="float-left ">
            <p class="p-3 bg-danger text-white rounded " style="margin: 10px ">Error: {{msjErr}}</p>
        </div>
        <div class="float-left ">
            <p class="p-3 bg-success text-white rounded " style="margin: 10px ">OK: {{msjOK}}</p>
        </div>-->

    </div>
</div>
<div *ngIf="failActualizado" class="float-left">
    <p class="p-3 bg-danger text-white rounded" style="margin: 10px">Error: {{msjErr}}</p>
</div>
<div *ngIf="actualizado" class="float-left">
    <p class="p-3 bg-success text-white rounded" style="margin: 10px">OK: {{msjOK}}</p>
</div>
<ng-template #cargarImagen>
    <div class="card-body">
        <h3>Selecciona una imagen de la galeria</h3>
        <div class="row">
            <div class="col-12 col-md-12 col-lg-8 col-xl-6 " *ngFor="let image of images">
                <div class="card text-center shadow-sm border-0 mb-4">
                    <div class="offer bg-warning text-white right">Imagenes de usuario</div>
                    <div class="card-img-top">
                        <div class="background" *ngIf="image.retrievedImages">
                            <img [src]="image.retrievedImages">

                        </div>
                    </div>
                    <div class="card-body">
                        <h6 class="template-primary">Nombre imagen: {{image.name}}</h6>
                        <div class="row my-3">
                            <div class="col text-left">
                                <h5 class="font-weight-light mb-0"> </h5>
                            </div>

                        </div>

                        <div class="row my-3">
                            <div class="col text-left">
                                <h5><button type="button" (click)="selecionImagen(image)" class="btn btn-success float-right" style="margin-left: 10px;">Seleccionar</button></h5>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>

</ng-template>